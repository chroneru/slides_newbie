ans_u <- readline("おうとうってなんだ？: ")
if (ans_u == answer) print("あってるよ")
else print("まちがってるよ")
}
quiz()
pareto_func <- function(vec) {
res_count <- c("a" = NA, "b" = NA, "c" = NA, "d" = NA, "e" = NA)
for(moji in c("a", "b", "c", "d", "e")) {
res_count[moji] <- sum(vec == moji)
}
res_count <- sort(res_count, decreasing = TRUE)
res_pareto <- cumsum(res_count)
res_pareto <- res_pareto / res_pareto[5]
list("count" = res_count, "density" = res_pareto)
}
cumsum( c(1, 2, 3, 4, 5))
sample(1:100, size = 2)
prob_vec <- sample(1:5, size = 5)
vec1 <- sample(
1:5,
size = 10000,
replace = TRUE,
prob = prob_vec
)
replace_abcde <- function(vec1) {
num <- 1
for(moji in c("a", "b", "c", "d", "e")) {
vec1[vec1 == num] <- moji
num <- num + 1
}
assign("vec1", vec1, envir = parent.env(environment()))
}
replace_abcde(vec1)
result <- pareto_func(vec1)
result
result <- as_tibble(result) %>%
mutate(
name = names(result$count),
count_density = count / sum(count)
)
result %>%
ggplot() +
geom_hline(
yintercept = c(0.7,0.9,1),
size = 0.2,
color = "#ff0000"
) +
geom_bar(
aes(name, count_density, fill = density),
stat = "identity"
) +
geom_line(aes(name, density, group ="1")) +
geom_point(
aes(name, density, color = density),
size = 5
) +
scale_x_discrete(limits = result$name) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1)) +
scale_color_gradient(low = "#006600", high = "#ccffcc") +
scale_fill_gradient(low = "#006600", high = "#ccffcc") +
#  viridis::scale_fill_viridis(option="inferno") +
#  viridis::scale_color_viridis() +
coord_cartesian(ylim = c(0,1)) +
labs(
x = names(result$count),
y = NULL
) +
theme(legend.position = "none")
# ggsave("pareto_graph.png")
knitr::include_graphics("Image/newbie_workshop_image/pareto_graph.png")
head(ToothGrowth)
class(ToothGrowth)
knitr::include_graphics("Image/newbie_workshop_image/guinea-pig-242520_1920.jpg")
ToothGrowth2 <- as_tibble(ToothGrowth)
ToothGrowth2 %>% head(2) %>% knitr::kable()
ToothGrowth2 %>% tail(2) %>% knitr::kable()
names(ToothGrowth2) <- c("Tooth_length", "Supplement", "Dose")
ToothGrowth2 %>% head() %>% knitr::kable()
ToothGrowth2 %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point()
ToothGrowth2_VC_lm <- lm(Tooth_length ~ Dose, data = ToothGrowth2 %>% filter(Supplement == "VC"))
ToothGrowth2_OJ_lm <- lm(Tooth_length ~ Dose, data = ToothGrowth2 %>% filter(Supplement == "OJ"))
ToothGrowth2_lm <- list(VC_lm = summary(ToothGrowth2_VC_lm), OJ_lm = summary(ToothGrowth2_OJ_lm))
ToothGrowth2_lm
# Tooth_length = 3.295 + 11.716 * Dose
# Tooth_length = 11.550 + 7.811 * Dose
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
ToothGrowth2_OJ_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "OJ"), verbose = 10000)
ToothGrowth2_bayes_lm <- list(VC_bayes_lm = summary(ToothGrowth2_VC_bayes_lm), OJ_bayes_lm = summary(ToothGrowth2_OJ_bayes_lm))
ToothGrowth2_bayes_lm
#
ToothGrowth2_bayes_lm
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
ToothGrowth2_OJ_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "OJ"), verbose = 10000)
list(VC_bayes_lm = ToothGrowth2_VC_bayes_lm, OJ_bayes_lm = ToothGrowth2_OJ_bayes_lm)
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
ToothGrowth2_OJ_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "OJ"), verbose = 10000)
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
ToothGrowth2_bayes_lm <- list(VC_bayes_lm = summary(ToothGrowth2_VC_bayes_lm), OJ_bayes_lm = summary(ToothGrowth2_OJ_bayes_lm))
ToothGrowth2_bayes_lm
#options(prompt = "#> $ ")
#options(continue = "#> $ ") #行末継続子
knitr::opts_chunk$set(
comment = "#>",
collapse = TRUE
)
#TRUEでprompt表示
#knitr::opts_current$set(prompt=FALSE, eval = FALSE)
#rmarkdown::render("newbie_workshop.Rmd", "revealjs_presentation", "newbie_workshop.html")
#rmarkdown::render("newbie_workshop.Rmd", "html_document", "newbie_workshop_pages.html")
library(tidyverse)
ToothGrowth2 <- as_tibble(ToothGrowth)
names(ToothGrowth2) <- c("Tooth_length", "Supplement", "Dose")
ToothGrowth2 %>% head() %>% knitr::kable()
ToothGrowth2_VC_lm <- lm(Tooth_length ~ Dose, data = ToothGrowth2 %>% filter(Supplement == "VC"))
ToothGrowth2_OJ_lm <- lm(Tooth_length ~ Dose, data = ToothGrowth2 %>% filter(Supplement == "OJ"))
ToothGrowth2_VC_bayes_lm <- MCMCpack::MCMCregress(Tooth_length ~ Dose, ToothGrowth2 %>% filter(Supplement == "VC"), verbose = 10000)
str(ToothGrowth2_VC_bayes_lm)
head(ToothGrowth2_VC_bayes_lm)
ToothGrowth2_VC_bayes_lm[1]
ToothGrowth2_VC_bayes_lm[11000]
ToothGrowth2_VC_bayes_lm[11000,]
ToothGrowth2_VC_bayes_lm[11000,1]
ToothGrowth2_VC_bayes_lm[11000]
ToothGrowth2_VC_bayes_lm[[11000]
]
ToothGrowth2_VC_bayes_lm[11001]
length(ToothGrowth2_VC_bayes_lm)
?stat_function
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
ggplot(aes(Dose = c(0.5, 2))) +
stat_function(fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line")
library(tidyverse)
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
ggplot(aes(Dose = c(0.5, 2))) +
stat_function(fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line")
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line")
?ggplot
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
Dose_range <- data.frame(Dose = c(0.5, 2))
stat_function()
?stat_function
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) #+
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#  ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#  ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose_range$Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#  ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(data = Dose_range,
mapping = aes(Dose_range[["Dose"]]),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4")
ToothGrowth2
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#  ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
par(new = T)
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ggplot(data.frame(Dose = c(0.5, 2)), aes(Dose)) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ggplot() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2
lapply(ToothGrowth2$Tooth_length, min)
min(ToothGrowth2$Tooth_length)
max(ToothGrowth2$Tooth_length)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
Dose_range <- data.frame(Dose = c(0.5, 2), Tooth_length = c(4, 35))
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#ggplot() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
# Tooth_length = 3.312 + 11.703 * Dose
# Tooth_length = 11.571 + 7.796 * Dose
Dose_range <- data.frame(Dose = c(0.5, 2), Tooth_length = c(4, 34))
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
#  geom_smooth(method = "lm", se = FALSE) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
size = 2
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4"
size = 2
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4",
size = 2
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4",
size = 1
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d"
)
ToothGrowth2 %>%
group_by(Supplement) %>%
ggplot(aes(Dose, Tooth_length, color = Supplement)) +
geom_point() +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 3.312 + 11.703 * Dose,
geom = "line",
color = "#00bfc4",
size = 1
) +
stat_function(
data = Dose_range,
mapping = aes(Dose),
fun = function(Dose) 11.571 + 7.796 * Dose,
geom = "line",
color = "#f8766d",
size = 1
)
